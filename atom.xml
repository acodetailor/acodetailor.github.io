<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Sam</title>
  
  <subtitle>ç”¨æˆ‘çš„åŒæ‰‹ï¼Œæˆå°±ä½ çš„æ¢¦æƒ³ã€‚ä¸€åº“~</subtitle>
  <link href="https://acodetailor.github.io/atom.xml" rel="self"/>
  
  <link href="https://acodetailor.github.io/"/>
  <updated>2021-04-19T10:05:30.896Z</updated>
  <id>https://acodetailor.github.io/</id>
  
  <author>
    <name>Sam</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Minikubeæ­å»ºistioå’ŒKnative</title>
    <link href="https://acodetailor.github.io/2021/04/19/install%20knative/"/>
    <id>https://acodetailor.github.io/2021/04/19/install%20knative/</id>
    <published>2021-04-19T09:26:51.731Z</published>
    <updated>2021-04-19T10:05:30.896Z</updated>
    
    <content type="html"><![CDATA[<p>éœ€è¦æ­å»ºä¸€å¥—knativeçš„æµ‹è¯•ç¯å¢ƒï¼Œä½†æ˜¯æ²¡æœ‰æµ‹è¯•é›†ç¾¤å¯ä»¥ç”¨äº†ï¼Œå°±ç”¨è‡ªå·±çš„ç”µè„‘æ­å»ºäº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒã€‚æ­å»ºè¿‡ç¨‹è®°å½•ä¸€ä¸‹</p><h4 id="ç¯å¢ƒä¿¡æ¯"><a href="#ç¯å¢ƒä¿¡æ¯" class="headerlink" title="ç¯å¢ƒä¿¡æ¯"></a>ç¯å¢ƒä¿¡æ¯</h4><p>os:Mac<br>Driver:VirtualBox</p><h4 id="æ­å»ºminikube"><a href="#æ­å»ºminikube" class="headerlink" title="æ­å»ºminikube"></a>æ­å»ºminikube</h4><p>ä¸€æ¡å‘½ä»¤å³å¯,å¯ä»¥æŒ‡å®šcpuå’Œå†…å­˜â€“cpus int  â€“memory int</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">minikube start --vm-driver=virtualbox --image-repository=<span class="string">&#x27;registry.cn-hangzhou.aliyuncs.com/google_containers&#x27;</span></span><br></pre></td></tr></table></figure><p>minikubeå¸¸ç”¨å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1. minikube startå¯åŠ¨minikube</span><br><span class="line">2. minikube dashboard æ‰“å¼€dashboard</span><br><span class="line">3. minikube versionæŸ¥çœ‹minikubeç‰ˆæœ¬</span><br><span class="line">4. minikube status æŸ¥çœ‹é›†ç¾¤çŠ¶æ€</span><br><span class="line">5. minikube ip æ˜¾ç¤ºè™šæ‹Ÿæœºipåœ°å€</span><br><span class="line">6. minikube stop  åœæ­¢è™šæ‹Ÿæœº</span><br><span class="line">7. minikube ssh  sshåˆ°è™šæ‹Ÿæœºä¸­</span><br><span class="line">8. minikube  delete åˆ é™¤è™šæ‹Ÿæœº</span><br><span class="line">9. minikube logsæŸ¥çœ‹è™šæ‹Ÿæœºæ—¥å¿—</span><br><span class="line">10. minikube update-check æ£€æŸ¥æ›´æ–°</span><br><span class="line">11. minikube node list[add|start|stop|delete] å¯¹èŠ‚ç‚¹è¿›è¡Œæ“ä½œ</span><br><span class="line">12. minikube mount å°†æŒ‡å®šçš„ç›®å½•æŒ‚è½½åˆ°minikube</span><br><span class="line">13. minikube docker-env  é…ç½®ç¯å¢ƒä»¥ä½¿ç”¨minikubeçš„dockerå®ˆæŠ¤è¿›ç¨‹</span><br><span class="line">14. minikube podman-env  é…ç½®ç¯å¢ƒä»¥ä½¿ç”¨minikubeçš„PodmanæœåŠ¡</span><br><span class="line">15. minikube cache æ·»åŠ ï¼Œåˆ é™¤ï¼Œæˆ–æ¨é€ä¸€ä¸ªæœ¬åœ°æ˜ åƒåˆ°minikube</span><br><span class="line">16. minikube addons å¯ç”¨æˆ–ç¦ç”¨ä¸€ä¸ªminikubeæ’ä»¶</span><br><span class="line">17. minikube config  ä¿®æ”¹æŒä¹…åŒ–é…ç½®å€¼</span><br><span class="line">18. minikube  profile  è·å–æˆ–è€…åˆ—å‡ºå½“å‰çš„é…ç½®æ–‡ä»¶ï¼ˆé›†ç¾¤ï¼‰</span><br><span class="line">19. minikube update-context  åœ¨IPæˆ–è€…ç«¯å£æ”¹å˜çš„æƒ…å†µä¸‹æ›´æ–°kubeconfig</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸåæç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ğŸ˜„  Darwin 10.14.6 ä¸Šçš„ minikube v1.8.2</span><br><span class="line">âœ¨  æ ¹æ®ç°æœ‰çš„é…ç½®æ–‡ä»¶ä½¿ç”¨ virtualbox é©±åŠ¨ç¨‹åº</span><br><span class="line">âœ…  æ­£åœ¨ä½¿ç”¨é•œåƒå­˜å‚¨åº“ registry.cn-hangzhou.aliyuncs.com/google_containers</span><br><span class="line">ğŸ’¾  Downloading preloaded images tarball <span class="keyword">for</span> k8s v1.17.3 ...</span><br><span class="line">âŒ›  é‡æ–°é…ç½®ç°æœ‰ä¸»æœº</span><br><span class="line">ğŸƒ  Using the running virtualbox <span class="string">&quot;minikube&quot;</span> VM ...</span><br><span class="line">ğŸ³  æ­£åœ¨ Docker 19.03.6 ä¸­å‡†å¤‡ Kubernetes v1.17.3â€¦</span><br><span class="line">ğŸš€  æ­£åœ¨å¯åŠ¨ Kubernetes ... </span><br><span class="line">ğŸŒŸ  Enabling addons: default-storageclass, storage-provisioner</span><br><span class="line">ğŸ„  å®Œæˆï¼kubectl å·²ç»é…ç½®è‡³ <span class="string">&quot;minikube&quot;</span></span><br></pre></td></tr></table></figure><h4 id="æ­å»ºistio"><a href="#æ­å»ºistio" class="headerlink" title="æ­å»ºistio"></a>æ­å»ºistio</h4><p>ä¸‹è½½istioçš„åŒ…ï¼Œç„¶åæ ¹æ®æç¤ºé…ç½®ç¯å¢ƒå˜é‡ï¼Œç”±äºæŸäº›å·²çŸ¥åŸå› ï¼Œå¯ä»¥é…ç½®host</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">199.232.28.133 raw.githubusercontent.com</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://istio.io/downloadIstio | ISTIO_VERSION=1.9.1 TARGET_ARCH=x86_64 sh -</span><br></pre></td></tr></table></figure><p>å®‰è£…å‘½ä»¤ï¼šæ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„profile</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">istioctl manifest apply --<span class="built_in">set</span> profile=demo //ä½¿ç”¨è¿™æ¡å‘½ä»¤å®‰è£…å¤±è´¥äº†ã€‚</span><br><span class="line">istioctl install --<span class="built_in">set</span> profile=demo -y</span><br></pre></td></tr></table></figure><p>è¿½åŠ éƒ¨ç½²addons</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> istio-1.9.1</span><br><span class="line">kc  --context=minikube apply -f samples/addons -n istio-system</span><br></pre></td></tr></table></figure><h4 id="æ­å»ºknative"><a href="#æ­å»ºknative" class="headerlink" title="æ­å»ºknative"></a>æ­å»ºknative</h4><p>knativeæ­å»ºæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…ï¼Œå†éº»çƒ¦ä¸€ç‚¹ï¼Œå¯ä»¥è‡ªå·±ä¸‹è½½yamlæ‰‹åŠ¨æ‰§è¡Œï¼Œservingå’Œeventingä¸€å…±å››ä¸ªyaml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">serving-crds</span><br><span class="line">serving-core</span><br><span class="line">eventing-crds</span><br><span class="line">eventing-core</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply --filename <span class="string">&quot;https://github.com/knative/serving/releases/download/v0.17.0/serving-crds.yaml&quot;</span></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒéº»çƒ¦çš„æ˜¯é•œåƒï¼Œå›½å†…æ— æ³•ç›´æ¥ä¸‹è½½åˆ°ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½åï¼Œä½¿ç”¨minikube cache æ·»åŠ åˆ°minikubeçš„èŠ‚ç‚¹ä¸Šã€‚</p><h4 id="ç»“æœ"><a href="#ç»“æœ" class="headerlink" title="ç»“æœ"></a>ç»“æœ</h4><p><img src="../../../../image/install/knative.png" alt="reason"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;éœ€è¦æ­å»ºä¸€å¥—knativeçš„æµ‹è¯•ç¯å¢ƒï¼Œä½†æ˜¯æ²¡æœ‰æµ‹è¯•é›†ç¾¤å¯ä»¥ç”¨äº†ï¼Œå°±ç”¨è‡ªå·±çš„ç”µè„‘æ­å»ºäº†ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒã€‚æ­å»ºè¿‡ç¨‹è®°å½•ä¸€ä¸‹&lt;/p&gt;
&lt;h4 id=&quot;ç¯å¢ƒä¿¡æ¯&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒä¿¡æ¯&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒä¿¡æ¯&quot;&gt;&lt;/a&gt;ç¯å¢ƒä¿¡æ¯&lt;/h4&gt;</summary>
      
    
    
    
    <category term="k8s" scheme="https://acodetailor.github.io/categories/k8s/"/>
    
    
    <category term="k8s" scheme="https://acodetailor.github.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡OOMçš„é—®é¢˜æ’æŸ¥</title>
    <link href="https://acodetailor.github.io/2021/04/12/ops-oom/"/>
    <id>https://acodetailor.github.io/2021/04/12/ops-oom/</id>
    <published>2021-04-12T13:03:40.025Z</published>
    <updated>2021-04-12T13:34:52.892Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€é—®é¢˜ç°è±¡"><a href="#ä¸€ã€é—®é¢˜ç°è±¡" class="headerlink" title="ä¸€ã€é—®é¢˜ç°è±¡"></a>ä¸€ã€é—®é¢˜ç°è±¡</h1><ul><li>ä¸‰å¤©å‰ï¼Œä¸šåŠ¡çš„podé‡å¯äº†ï¼Œä¸šåŠ¡æƒ³çŸ¥é“å…·ä½“åŸå› ã€‚</li></ul><p><img src="../../../../image/problem/0412/%E4%B8%9A%E5%8A%A1%E6%97%A5%E5%BF%97.png" alt="reason"></p><h1 id="äºŒã€æ’æŸ¥è®°å½•"><a href="#äºŒã€æ’æŸ¥è®°å½•" class="headerlink" title="äºŒã€æ’æŸ¥è®°å½•"></a>äºŒã€æ’æŸ¥è®°å½•</h1><ul><li>é¦–å…ˆæ’æŸ¥kubeletæ—¥å¿—ï¼Œè›‹ç–¼çš„æ˜¯æœŸé—´ä¸šåŠ¡æ‰‹åŠ¨é‡å¯äº†å‡ æ¬¡ï¼Œå¯¼è‡´ä¸çŸ¥é“podé‡å¯æ—¶æ‰€åœ¨çš„èŠ‚ç‚¹ã€‚<br>ä¸€ä¸ªä¸ªèŠ‚ç‚¹æ’æŸ¥kubeletçš„æ—¥å¿—ï¼ˆä¸çŸ¥é“åç»­æœ‰æ²¡æœ‰å¥½çš„æ–¹æ³•ï¼‰ï¼Œæ‰¾åˆ°èŠ‚ç‚¹å‘ç°æ—¥å¿—å¦‚ä¸‹ï¼š</li></ul><p><img src="../../../../image/problem/0412/kubelet%E6%97%A5%E5%BF%97.png" alt="reason"></p><p>  kubeletæ‰§è¡ŒPLEGæ—¶å‘ç°å®¹å™¨æŒ‚æ‰äº†ï¼Œç›´æ¥ç»™æ‹‰èµ·äº†ï¼Œå°±æ˜¯ä¸šåŠ¡å‰å°å‘ç°çš„é‡å¯äº‹ä»¶ã€‚</p><ul><li>å†æ’æŸ¥ä¸šåŠ¡æ—¥å¿—ï¼Œå‘ç°åªæœ‰Killed,å…«æˆæ˜¯OOMäº†ã€‚æ—¥å¿—æˆªå›¾å¦‚ä¸‹ï¼š</li></ul><p><img src="../../../../image/problem/0412/%E6%9C%8D%E5%8A%A1%E6%97%A5%E5%BF%97.png" alt="reason"></p><ul><li>ä¸‹ä¸€æ­¥æ’æŸ¥å†…æ ¸æ—¥å¿—ï¼Œkerenalã€‚å‘ç°ç¡®å®æ˜¯OOMäº†ã€‚æˆªå›¾å¦‚ä¸‹:</li></ul><p><img src="../../../../image/problem/0412/cgroup%E6%97%A5%E5%BF%97.png" alt="reason"></p><ul><li>ç„¶åé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬çš„ç›‘æ§å‘ç°å¹¶æ²¡æœ‰è¾¾åˆ°å†…å­˜çš„ä¸Šé™ï¼Œä½†æ˜¯cgroupç¡®å®è¾¾åˆ°äº†ä¸Šé™ã€‚çœŸæ˜¯è®©äººå¤´å¤§å•Šã€‚</li></ul><h1 id="ä¸‰ã€å‡ ä¸ªå‘½ä»¤"><a href="#ä¸‰ã€å‡ ä¸ªå‘½ä»¤" class="headerlink" title="ä¸‰ã€å‡ ä¸ªå‘½ä»¤"></a>ä¸‰ã€å‡ ä¸ªå‘½ä»¤</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zgrep <span class="string">&quot;&quot;</span> *.gz</span><br><span class="line">journalctl --since <span class="string">&#x27;2021-04-09 22:00&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="å››ã€å¼•ç”³é—®é¢˜"><a href="#å››ã€å¼•ç”³é—®é¢˜" class="headerlink" title="å››ã€å¼•ç”³é—®é¢˜"></a>å››ã€å¼•ç”³é—®é¢˜</h1><ul><li>1ã€cgroupçš„æœºåˆ¶</li><li>2ã€javaçš„å†…å­˜æœºåˆ¶</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸€ã€é—®é¢˜ç°è±¡&quot;&gt;&lt;a href=&quot;#ä¸€ã€é—®é¢˜ç°è±¡&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€é—®é¢˜ç°è±¡&quot;&gt;&lt;/a&gt;ä¸€ã€é—®é¢˜ç°è±¡&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;ä¸‰å¤©å‰ï¼Œä¸šåŠ¡çš„podé‡å¯äº†ï¼Œä¸šåŠ¡æƒ³çŸ¥é“å…·ä½“åŸå› ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=</summary>
      
    
    
    
    <category term="è¿ç»´" scheme="https://acodetailor.github.io/categories/%E8%BF%90%E7%BB%B4/"/>
    
    
    <category term="oom" scheme="https://acodetailor.github.io/tags/oom/"/>
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://acodetailor.github.io/2021/04/09/TCP/"/>
    <id>https://acodetailor.github.io/2021/04/09/TCP/</id>
    <published>2021-04-09T06:37:26.865Z</published>
    <updated>2021-04-09T06:37:26.865Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://acodetailor.github.io/2021/04/09/Iptabels%20And%20Ipvs/"/>
    <id>https://acodetailor.github.io/2021/04/09/Iptabels%20And%20Ipvs/</id>
    <published>2021-04-09T06:37:13.851Z</published>
    <updated>2021-04-09T06:37:13.851Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>terraform cloud CLI</title>
    <link href="https://acodetailor.github.io/2021/04/07/terraform_cloud/"/>
    <id>https://acodetailor.github.io/2021/04/07/terraform_cloud/</id>
    <published>2021-04-07T02:02:39.990Z</published>
    <updated>2021-04-07T05:41:50.275Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><ul><li>terraformè‡ªèº«æä¾›å¯ä¸€ä¸ªæœºåˆ¶ï¼ˆç±»ä¼¼CI/CDçš„æµæ°´çº¿ï¼‰ï¼Œå¯ä»¥é…ç½®è‡ªå·±çš„gitåº“ï¼Œæ ¹æ®gitåº“æ–‡ä»¶å†…å®¹çš„å˜åŒ–ï¼Œæ‰§è¡Œ<br>planã€applyï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œã€‚ä»¥åŠé…ç½®å˜é‡æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€stateæ–‡ä»¶ç»Ÿä¸€å­˜å‚¨ç­‰ç­‰åŠŸèƒ½ã€‚</li></ul><h1 id="äºŒã€å¯¹æ¯”"><a href="#äºŒã€å¯¹æ¯”" class="headerlink" title="äºŒã€å¯¹æ¯”"></a>äºŒã€å¯¹æ¯”</h1><p>1ã€ä½¿ç”¨terraformäºŒè¿›åˆ¶ã€‚</p><ul><li>éœ€è¦ä¸‹è½½provider(terraform init)</li><li>ç¼–å†™tfæ–‡ä»¶ï¼Œbackendå­˜å‚¨ã€‚ä¹Ÿéœ€è¦ç»Ÿä¸€çš„é…ç½®ç®¡ç†ã€‚</li><li>æ¯æ¬¡æ‰‹åŠ¨è§¦å‘ã€‚  </li></ul><p>2ã€ä½¿ç”¨Cloud CLIã€‚</p><ul><li>ä¸éœ€è¦å‡†å¤‡provider</li><li>ç»Ÿä¸€çš„é…ç½®ç®¡ç†</li><li>git pushåå³è§¦å‘ terraform</li></ul><h1 id="ä¸‰ã€æ —å­"><a href="#ä¸‰ã€æ —å­" class="headerlink" title="ä¸‰ã€æ —å­"></a>ä¸‰ã€æ —å­</h1><h4 id="1ã€åˆ›å»ºç»„ç»‡"><a href="#1ã€åˆ›å»ºç»„ç»‡" class="headerlink" title="1ã€åˆ›å»ºç»„ç»‡"></a>1ã€åˆ›å»ºç»„ç»‡</h4><ul><li>terraformç½‘ç«™åˆ›å»ºå³å¯ã€‚ <a href="https://app.terraform.io/">https://app.terraform.io</a><h4 id="2ã€é…ç½®gitåº“"><a href="#2ã€é…ç½®gitåº“" class="headerlink" title="2ã€é…ç½®gitåº“"></a>2ã€é…ç½®gitåº“</h4></li><li>å¯ä»¥ä½¿ç”¨ä¸ªäººçš„gitåº“ï¼Œé…ç½®Oauthæƒé™ã€‚æ ¹æ®æç¤º åœ¨github-&gt;setting-&gt;developer settings-&gt; oauth appsç”³è¯·é…ç½®å³å¯ã€‚  </li></ul><h4 id="3ã€é€‰æ‹©å·¥ç¨‹"><a href="#3ã€é€‰æ‹©å·¥ç¨‹" class="headerlink" title="3ã€é€‰æ‹©å·¥ç¨‹"></a>3ã€é€‰æ‹©å·¥ç¨‹</h4><ul><li>gitæ–°å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œç„¶åå†terraformå¤„é€‰æ‹©è¯¥å·¥ç¨‹ã€‚  </li></ul><p><img src="../../../../image/terraform/terraformcloud.jpg" alt="chooserepo"></p><h4 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h4><ul><li>æ‰§è¡ŒRunå³å¯ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½ä¼šè§¦å‘ plan,ç„¶åéœ€è¦æ‰‹åŠ¨æ‰§è¡Œapplyã€‚  </li></ul><h4 id="5ã€ç»“æœ"><a href="#5ã€ç»“æœ" class="headerlink" title="5ã€ç»“æœ"></a>5ã€ç»“æœ</h4><p><img src="../../../../image/terraform/terraformapply.jpg" alt="apply"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ä¸€ã€ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ä¸€ã€ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ä¸€ã€ç®€ä»‹&quot;&gt;&lt;/a&gt;ä¸€ã€ç®€ä»‹&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;terraformè‡ªèº«æä¾›å¯ä¸€ä¸ªæœºåˆ¶ï¼ˆç±»ä¼¼CI/CDçš„æµæ°´çº¿ï¼‰ï¼Œå¯ä»¥é…ç½®è‡ªå·±çš„gitåº“ï¼Œæ ¹æ®gitåº“æ–‡ä»¶å†…å®¹çš„å˜</summary>
      
    
    
    
    <category term="terraform" scheme="https://acodetailor.github.io/categories/terraform/"/>
    
    
    <category term="terraform" scheme="https://acodetailor.github.io/tags/terraform/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes CRD -- kubebuilderæ­å»º</title>
    <link href="https://acodetailor.github.io/2021/04/02/k8s_crd/"/>
    <id>https://acodetailor.github.io/2021/04/02/k8s_crd/</id>
    <published>2021-04-02T02:17:18.350Z</published>
    <updated>2021-04-02T03:53:26.061Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><p>å®˜æ–¹è§£é‡Šï¼šCustomResourceDefinition API èµ„æºå…è®¸ä½ å®šä¹‰å®šåˆ¶èµ„æºã€‚ å®šä¹‰ CRD å¯¹è±¡çš„æ“ä½œä¼šä½¿ç”¨ä½ æ‰€è®¾å®šçš„åå­—å’Œæ¨¡å¼å®šä¹‰ï¼ˆSchemaï¼‰<br>åˆ›å»ºä¸€ä¸ªæ–°çš„å®šåˆ¶èµ„æºï¼Œ Kubernetes API è´Ÿè´£ä¸ºä½ çš„å®šåˆ¶èµ„æºæä¾›å­˜å‚¨å’Œè®¿é—®æœåŠ¡ã€‚ CRD å¯¹è±¡çš„åç§°å¿…é¡»æ˜¯åˆæ³•çš„ DNS å­åŸŸåã€‚</p><p>DNSå­åŸŸåè§„åˆ™å¦‚ä¸‹ï¼š</p><ul><li>ä¸èƒ½è¶…è¿‡253ä¸ªå­—ç¬¦</li><li>åªèƒ½åŒ…å«å°å†™å­—æ¯ã€æ•°å­—ï¼Œä»¥åŠâ€™-â€˜ å’Œ â€˜.â€™</li><li>é¡»ä»¥å­—æ¯æ•°å­—å¼€å¤´</li><li>é¡»ä»¥å­—æ¯æ•°å­—ç»“å°¾</li></ul><p>ç®€å•æ¥è¯´ï¼Œä½ å¯ä»¥å®šä¹‰åƒk8såŸç”Ÿèµ„æºå¦‚deploymentã€serviceä¸€æ ·å®šä¹‰è‡ªå·±çš„èµ„æºï¼Œè€Œk8sä¼šä¸ºä½ æä¾›å­˜å‚¨ï¼ˆETCDï¼‰,è®¿é—®ï¼ˆkube-apiserverï¼‰ã€‚</p><h1 id="è„šæ‰‹æ¶"><a href="#è„šæ‰‹æ¶" class="headerlink" title="è„šæ‰‹æ¶"></a>è„šæ‰‹æ¶</h1><p>kubebuilder å’Œ operator sdk, ä¸ªäººåªä½¿ç”¨è¿‡kubebuilderã€‚</p><h1 id="å®‰è£…kubebuilder"><a href="#å®‰è£…kubebuilder" class="headerlink" title="å®‰è£…kubebuilder"></a>å®‰è£…kubebuilder</h1><h3 id="ä¾èµ–"><a href="#ä¾èµ–" class="headerlink" title="ä¾èµ–"></a>ä¾èµ–</h3><p>1ã€docker<br>2ã€go å»ºè®®ç‰ˆæœ¬åœ¨1.12ä»¥ä¸Šï¼Œæ”¯æŒ go mod<br>3ã€kustomize</p><h3 id="ä»£ç†é…ç½®"><a href="#ä»£ç†é…ç½®" class="headerlink" title="ä»£ç†é…ç½®"></a>ä»£ç†é…ç½®</h3><p>é…ç½®ä¸€ä¸‹ ç»ˆç«¯ä»£ç†ï¼Œå› ä¸ºåˆå§‹åŒ–æ—¶ä¼šæ‹‰å»goçš„ä¾èµ–åŒ…ã€‚<br>go 1.12ä¹‹ä¸‹å¼€å¯ go module</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> GOPROXY=https://goproxy.io</span><br><span class="line"><span class="built_in">export</span> GO111MODULE=on</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><strong>ä¸€ã€å®‰è£…kubebuilder</strong><br>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ã€‚ï¼ˆå¦‚æœcurlä¸‹è½½å¤±è´¥ï¼Œå¤§æ¦‚ç‡æ˜¯ç½‘ç»œåŸå› ï¼Œå¯ä»¥æ‰‹åŠ¨ä¸‹è½½ï¼Œè§£å‹åˆ°æŒ‡å®šç›®å½•ï¼‰ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">os= $(go env GOOS)</span><br><span class="line">arch=$(go env GOARCH)</span><br><span class="line">curl -L https://go.kubebuilder.io/dl/2.3.1/<span class="variable">$&#123;os&#125;</span>/<span class="variable">$&#123;arch&#125;</span> | tar -xz -C /tmp/</span><br><span class="line">sudo mv /tmp/kubebuilder_2.3.1_<span class="variable">$&#123;os&#125;</span>_<span class="variable">$&#123;arch&#125;</span> /usr/<span class="built_in">local</span>/kubebuilder</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/<span class="built_in">local</span>/kubebuilder/bin</span><br></pre></td></tr></table></figure><p><strong>äºŒã€å®‰è£…kustomize</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install kustomize </span><br></pre></td></tr></table></figure><p><strong>ä¸‰ã€å®‰è£…å®ŒæˆåæŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ kubebuilder version</span><br><span class="line">Version: version.Version&#123;KubeBuilderVersion:<span class="string">&quot;2.3.1&quot;</span>, KubernetesVendor:<span class="string">&quot;1.16.4&quot;</span>, GitCommit:<span class="string">&quot;8b53abeb4280186e494b726edf8f54ca7aa64a49&quot;</span>, BuildDate:<span class="string">&quot;2020-03-26T16:42:00Z&quot;</span>, GoOs:<span class="string">&quot;unknown&quot;</span>, GoArch:<span class="string">&quot;unknown&quot;</span>&#125;</span><br><span class="line"><span class="comment"># sam @ MacBook-Pro-2 in ~/tf/alitest [10:45:37]</span></span><br><span class="line">$ kustomize version</span><br><span class="line">&#123;Version:kustomize/v3.8.2 GitCommit:e2973f6ecc9be6187cfd5ecf5e180f842249b3c6 BuildDate:2020-09-02T07:01:55+01:00 GoOs:darwin GoArch:amd64&#125;</span><br></pre></td></tr></table></figure><p><strong>å››ã€åˆå§‹åŒ–å·¥ç¨‹</strong>  </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubebuilder init --domain my.crd.com  //åˆå§‹åŒ–å·¥ç¨‹</span><br><span class="line">kubebuilder create api --group custom --version v1 --kind Unit //ç”Ÿæˆè„šæ‰‹æ¶ä»£ç </span><br></pre></td></tr></table></figure><p> <strong>group</strong>: æ¯”å¦‚èµ„æºæ–‡ä»¶çš„apps/v1, appså³ä¸ºåˆ†ç»„ï¼Œè¿˜æœ‰å…¶ä»–extensionsã€coresç­‰ã€‚  </p><p> <strong>version</strong>: é¡¾åæ€ä¹‰ã€v1å³ä¸ºç‰ˆæœ¬ã€‚  </p><p> <strong>kind</strong>: API â€œé¡¶çº§â€èµ„æºå¯¹è±¡çš„ç±»å‹ï¼Œæ¯ä¸ªèµ„æºå¯¹è±¡éƒ½éœ€è¦ Kind æ¥åŒºåˆ†å®ƒè‡ªèº«ä»£è¡¨çš„èµ„æºç±»å‹ã€‚æ¯”å¦‚ pod,deployment.  </p><p> <strong>resource</strong>: é€šè¿‡ HTTP åè®®ä»¥ JSON æ ¼å¼å‘é€æˆ–è€…è¯»å–çš„èµ„æºå±•ç°å½¢å¼ï¼Œå¯ä»¥ä»¥å•ä¸ªèµ„æºå¯¹è±¡å±•ç°ã€‚  </p><p> <strong>GVK(groupã€versionã€kind)</strong>:<br>åŒ Kind ä¸æ­¢å¯ä»¥å‡ºç°åœ¨åŒä¸€åˆ†ç»„çš„ä¸åŒç‰ˆæœ¬ä¸­ï¼Œå¦‚ apps/v1beta1 ä¸ apps/v1ï¼Œå®ƒè¿˜å¯èƒ½å‡ºç°åœ¨ä¸åŒçš„åˆ†ç»„ä¸­ï¼Œä¾‹å¦‚ Deployment å¼€å§‹ä»¥ alpha çš„ç‰¹æ€§å‡ºç°åœ¨ extensions åˆ†ç»„ï¼ŒGA ä¹‹åè¢«æ¨è¿›åˆ° apps ç»„ï¼Œæ‰€ä»¥ä¸ºäº†ä¸¥æ ¼åŒºåˆ†ä¸åŒçš„ Kindï¼Œéœ€è¦ç»„åˆ API Groupã€API Version ä¸ Kind æˆä¸º GVKã€‚  </p><p> <strong>GVR(groupã€versionã€resource)</strong>:<br>GVR å¸¸ç”¨äºç»„åˆæˆ RESTful API è¯·æ±‚è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œé’ˆå¯¹åº”ç”¨ç¨‹åº v1 éƒ¨ç½²çš„ RESTful API è¯·æ±‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET /apis/apps/v1/namespaces/&#123;namespace&#125;/deployments/&#123;name&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#æ¦‚å¿µ&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚å¿µ&quot;&gt;&lt;/a&gt;æ¦‚å¿µ&lt;/h1&gt;&lt;p&gt;å®˜æ–¹è§£é‡Šï¼šCustomResourceDefinition API èµ„æºå…è®¸ä½ å®šä¹‰å®šåˆ¶èµ„æºã€‚ å®šä¹‰ CRD å¯¹è±¡çš„æ“ä½œä¼šä½¿ç”¨ä½ æ‰€è®¾å®šçš„åå­—å’Œ</summary>
      
    
    
    
    <category term="k8s" scheme="https://acodetailor.github.io/categories/k8s/"/>
    
    
    <category term="k8s" scheme="https://acodetailor.github.io/tags/k8s/"/>
    
  </entry>
  
  <entry>
    <title>Terraformä»‹ç»</title>
    <link href="https://acodetailor.github.io/2021/03/30/terraform/"/>
    <id>https://acodetailor.github.io/2021/03/30/terraform/</id>
    <published>2021-03-30T02:38:39.714Z</published>
    <updated>2021-04-01T08:23:43.207Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹ï¼š"><a href="#ç®€ä»‹ï¼š" class="headerlink" title="ç®€ä»‹ï¼š"></a>ç®€ä»‹ï¼š</h2><p>Terraformæ˜¯IT åŸºç¡€æ¶æ„è‡ªåŠ¨åŒ–ç¼–æ’å·¥å…·ï¼Œå®ƒçš„å£å·æ˜¯ â€œWrite,Plan, and create Infrastructure as Codeâ€, åŸºç¡€æ¶æ„å³ä»£ç ã€‚</p><p>æ€ä¹ˆç†è§£è¿™å¥è¯ï¼Œæˆ‘ä»¬å…ˆå‡è®¾åœ¨æ²¡æœ‰Terraformçš„å¹´ä»£æˆ‘ä»¬æ˜¯æ€ä¹ˆæ“ä½œäº‘æœåŠ¡ã€‚</p><p>æ–¹å¼ä¸€ï¼šç›´æ¥ç™»å…¥åˆ°äº‘å¹³å°çš„ç®¡æ§é¡µé¢ï¼Œäººå·¥ç‚¹å‡»æŒ‰é’®ã€é”®ç›˜æ•²å…¥è¾“å…¥å‚æ•°çš„æ–¹å¼æ¥æ“ä½œï¼Œè¿™ç§æ–¹å¼å¯¹äºå•ä¸ªæˆ–å‡ ä¸ªäº‘æœåŠ¡å™¨è¿˜å¯ä»¥ç»´æŠ¤çš„è¿‡æ¥ï¼Œä½†æ˜¯å½“äº‘æœåŠ¡è§„æ¨¡è¾¾åˆ°å‡ åå‡ ç™¾ç”šè‡³ä¸Šåƒä»¥åï¼Œæ˜æ˜¾è¿™ç§æ–¹å¼å¯¹äºäººåŠ›æ¥è¯´å˜å¾—ä¸å†ç°å®ï¼Œè€Œä¸”å®¹æ˜“è¯¯æ“ä½œã€‚</p><p>æ–¹å¼äºŒï¼šäº‘å¹³å°æä¾›äº†å„ç§SDKï¼Œå°†å¯¹äº‘æœåŠ¡çš„æ“ä½œæ‹†è§£æˆä¸€ä¸ªä¸ªçš„APIä¾›ä½¿ç”¨å‚å•†é€šè¿‡ä»£ç æ¥è°ƒç”¨ã€‚è¿™ç§æ–¹å¼æ˜æ˜¾å¥½äºæ–¹å¼ä¸€ï¼Œä½¿å¤§æ‰¹é‡æ“ä½œå˜å¾—å¯èƒ½ï¼Œè€Œä¸”ä»£ç æµ‹è¯•é€šè¿‡åå¯ä»¥é¿å…äººä¸ºè¯¯æ“ä½œã€‚ä½†æ˜¯éšä¹‹å¸¦æ¥çš„é—®é¢˜æ˜¯å‚å•†ä»¬éœ€è¦ä¸“ä¸šçš„å¼€å‘äººå‘˜ï¼ˆJavaã€Pythonã€Phpã€Rubyç­‰ï¼‰ï¼Œè€Œä¸”å¯¹å¤æ‚äº‘å¹³å°çš„æ“ä½œéœ€è¦å†™å¤§é‡çš„ä»£ç ã€‚</p><p>æ–¹å¼ä¸‰ï¼šäº‘å¹³å°æä¾›äº†å‘½ä»¤è¡Œæ“ä½œäº‘æœåŠ¡çš„å·¥å…·ï¼Œä¾‹å¦‚AWS CLIï¼Œè¿™æ ·ç§Ÿæˆ·å‚å•†ä¸å†éœ€è¦è½¯ä»¶å¼€å‘äººå‘˜å°±å¯ä»¥å®ç°å¯¹å¹³å°çš„å‘½ä»¤æ“ä½œã€‚å‘½ä»¤å°±åƒSqlä¸€æ ·ï¼Œä½¿ç”¨å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œå…ƒç´ æ¥ç®¡ç†äº‘ã€‚</p><p>æ–¹å¼å››ï¼šTerraformä¸»è§’ç™»åœºï¼Œå¦‚æœè¯´æ–¹å¼ä¸‰ä¸­CLIæ˜¯å‘½ä»¤å¼æ“ä½œï¼Œéœ€è¦æ˜ç¡®çš„å‘ŠçŸ¥äº‘æœåŠ¡æœ¬æ¬¡æ“ä½œæ˜¯æŸ¥è¯¢ã€æ–°å¢ã€ä¿®æ”¹ã€è¿˜æ˜¯åˆ é™¤ï¼Œé‚£ä¹ˆTerraformå°±æ˜¯ç›®çš„å¼æ“ä½œï¼Œåœ¨æœ¬åœ°ç»´æŠ¤äº†ä¸€ä»½äº‘æœåŠ¡çŠ¶æ€çš„æ¨¡æ¿ï¼Œæ¨¡æ¿ç¼–æ’æˆä»€ä¹ˆæ ·å­çš„ï¼Œäº‘æœåŠ¡å°±æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚å¯¹æ¯”æ–¹å¼ä¸‰çš„ä¼˜åŠ¿æ˜¯æˆ‘ä»¬åªéœ€è¦ä¸“æ³¨äºç¼–æ’ç»“æœå³å¯ï¼Œä¸éœ€è¦å…³å¿ƒç”¨ä»€ä¹ˆå‘½ä»¤å»æ“ä½œã€‚</p><p>Terraformçš„æ„ä¹‰åœ¨äºï¼Œé€šè¿‡åŒä¸€å¥—è§„åˆ™å’Œå‘½ä»¤æ¥æ“ä½œä¸åŒçš„äº‘å¹³å°ï¼ˆåŒ…æ‹¬ç§æœ‰äº‘ï¼‰ã€‚</p><h2 id="TerraformçŸ¥è¯†å‡†å¤‡ï¼š"><a href="#TerraformçŸ¥è¯†å‡†å¤‡ï¼š" class="headerlink" title="TerraformçŸ¥è¯†å‡†å¤‡ï¼š"></a>TerraformçŸ¥è¯†å‡†å¤‡ï¼š</h2><p>æ ¸å¿ƒæ–‡ä»¶æœ‰2ä¸ªï¼Œä¸€ä¸ªæ˜¯ç¼–æ’æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯çŠ¶æ€æ–‡ä»¶</p><p>main.tfæ–‡ä»¶ï¼šæ˜¯ä¸šåŠ¡ç¼–æ’çš„ä¸»æ–‡ä»¶ï¼Œå®šåˆ¶äº†ä¸€ç³»åˆ—çš„ç¼–æ’è§„åˆ™ï¼Œåé¢ä¼šæœ‰è¯¦ç»†ä»‹ç»ã€‚</p><p>terraform.tfstateï¼šæœ¬åœ°çŠ¶æ€æ–‡ä»¶ï¼Œç›¸å½“äºæœ¬åœ°çš„äº‘æœåŠ¡çŠ¶æ€çš„å¤‡ä»½ï¼Œä¼šå½±å“terraformçš„æ‰§è¡Œè®¡åˆ’ã€‚</p><p>å¦‚æœæœ¬åœ°çŠ¶æ€ä¸äº‘æœåŠ¡çŠ¶æ€ä¸ä¸€æ ·æ—¶ä¼šæ€æ ·ï¼Ÿ</p><p>è¿™ä¸ªå¤§å®¶ä¸éœ€è¦æ‹…å¿ƒï¼Œå‰é¢ä»‹ç»è¿‡Terraformæ˜¯ç›®çš„å¼çš„ç¼–æ’ï¼Œä¼šæŒ‰ç…§é¢„è®¾ç»“æœå®Œæˆç¼–æ’å¹¶æœ€ç»ˆåŒæ­¥æ›´æ–°æœ¬åœ°æ–‡ä»¶ã€‚</p><p>Providerï¼šTerraformå®šåˆ¶çš„ä¸€å¥—æ¥å£ï¼Œè·ŸOpenStacké‡ŒDirverã€Javaé‡ŒInterfaceçš„æ¦‚å¿µæ˜¯ä¸€æ ·çš„ï¼Œé˜¿é‡Œäº‘ã€AWSã€ç§æœ‰äº‘ç­‰å¦‚æœæƒ³æ¥å…¥è¿›æ¥è¢«Terraformç¼–æ’å’Œç®¡ç†å°±è¦å®ç°ä¸€å¥—Providerï¼Œè€Œè¿™äº›å®ç°å¯¹äºTerraformçš„é¡¶å±‚ä½¿ç”¨è€…æ¥è¯´æ˜¯æ— æ„ŸçŸ¥çš„ã€‚</p><p>Moduleï¼šå¯ä»¥ç†è§£ä¸ºproviderçš„é›†åˆï¼Œå®Œæˆä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½ã€‚</p><h2 id="ç›¸å…³å‘½ä»¤ï¼š"><a href="#ç›¸å…³å‘½ä»¤ï¼š" class="headerlink" title="ç›¸å…³å‘½ä»¤ï¼š"></a>ç›¸å…³å‘½ä»¤ï¼š</h2><h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p>åˆå§‹åŒ–æœ¬åœ°ç¯å¢ƒï¼Œä¸‹è½½provider,æ ¡éªŒterraformç‰ˆæœ¬ç­‰.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ terraform init              //è‡ªåŠ¨ä¸‹è½½æœ€æ–°çš„provider</span><br><span class="line">$ terraform init -plugin-dir  //æŒ‡å®šproviderç›®å½•</span><br></pre></td></tr></table></figure><h2 id="plan"><a href="#plan" class="headerlink" title="plan"></a>plan</h2><p>æ¯”è¾ƒäº‘ç«¯èµ„æºå’Œæœ¬åœ°stateèµ„æº.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ terraform plan</span><br></pre></td></tr></table></figure><h2 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h2><p>å°†ä¿®æ”¹éƒ¨ç½²åˆ°äº‘ç«¯èµ„æº.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ terraform apply</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>å°†äº‘ç«¯èµ„æºåˆ é™¤.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ terraform destory</span><br></pre></td></tr></table></figure><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>åˆ›å»ºé˜¿é‡Œäº‘ç”¨æˆ·ç»„ã€èµ„æºç»„å¹¶ä¸”é…ç½®åªè¯»æƒé™ã€‚<br>æ³¨: alicloud : é˜¿é‡Œäº‘provideråå­—ï¼Œä¸èƒ½ä¿®æ”¹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">provider <span class="string">&quot;alicloud&quot;</span> &#123;</span><br><span class="line">   access_key = <span class="string">&quot;*******************&quot;</span></span><br><span class="line">   secret_key = <span class="string">&quot;*************************&quot;</span></span><br><span class="line">   region = <span class="string">&quot;cn-beijing&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> resource <span class="string">&quot;alicloud_ram_group&quot;</span> <span class="string">&quot;group&quot;</span> &#123;</span><br><span class="line">   name     = <span class="string">&quot;test_group_1000&quot;</span></span><br><span class="line">   force    = <span class="literal">true</span></span><br><span class="line"> &#125;</span><br><span class="line"> resource <span class="string">&quot;alicloud_ram_group_policy_attachment&quot;</span> <span class="string">&quot;attach&quot;</span> &#123;</span><br><span class="line">   policy_name = <span class="string">&quot;ReadOnlyAccess&quot;</span></span><br><span class="line">   policy_type = <span class="string">&quot;System&quot;</span></span><br><span class="line">   group_name  = alicloud_ram_group.group.name</span><br><span class="line"> &#125;</span><br><span class="line"> resource <span class="string">&quot;alicloud_resource_manager_resource_group&quot;</span> <span class="string">&quot;example&quot;</span> &#123;</span><br><span class="line">   resource_group_name = <span class="string">&quot;tftest01&quot;</span></span><br><span class="line">   display_name        = <span class="string">&quot;tftest01&quot;</span></span><br><span class="line"> &#125;</span><br><span class="line"> data <span class="string">&quot;alicloud_account&quot;</span> <span class="string">&quot;example&quot;</span> &#123;&#125;</span><br><span class="line"> resource <span class="string">&quot;alicloud_resource_manager_policy_attachment&quot;</span> <span class="string">&quot;example&quot;</span> &#123;</span><br><span class="line">   policy_name       = <span class="string">&quot;ReadOnlyAccess&quot;</span></span><br><span class="line">   policy_type       = <span class="string">&quot;System&quot;</span></span><br><span class="line">   principal_name    = format(<span class="string">&quot;%s@group.%s.onaliyun.com&quot;</span>, alicloud_ram_group.group.name, data.alicloud_account.example.id)</span><br><span class="line">   principal_type    = <span class="string">&quot;IMSGroup&quot;</span></span><br><span class="line">   resource_group_id = alicloud_resource_manager_resource_group.example.id</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>1ã€é…ç½®terraformè‡ªåŠ¨è¡¥å…¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ terraform -install-autocomplete</span><br></pre></td></tr></table></figure><p>2ã€æŸ¥çœ‹terraformçš„æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> TF_LOG=TRACE</span><br><span class="line">$ <span class="built_in">export</span> TF_LOG_PATH=/var/<span class="built_in">log</span>/terraform.log</span><br></pre></td></tr></table></figure><p>3ã€terraform é€šè¿‡é…ç½®æ–‡ä»¶æˆ–è€…ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®<br>æ–‡ä»¶ç›®å½•(è‡ªå·±åˆ›å»º)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="variable">$HOME</span>/.terraformrc </span><br></pre></td></tr></table></figure><p>ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ os.Setenv(<span class="string">&quot;TF_PLUGIN_CACHE_DIR&quot;</span>, <span class="string">&quot;/tmp/provider&quot;</span>) // add provider cache</span><br></pre></td></tr></table></figure><h2 id="stateæ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒconsulã€ossç­‰"><a href="#stateæ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒconsulã€ossç­‰" class="headerlink" title="stateæ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒconsulã€ossç­‰"></a>stateæ–‡ä»¶å­˜å‚¨ï¼Œæ”¯æŒconsulã€ossç­‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">terraform &#123;</span><br><span class="line">  backend <span class="string">&quot;consul&quot;</span> &#123;</span><br><span class="line">    address = <span class="string">&quot;consul.example.com&quot;</span></span><br><span class="line">    scheme  = <span class="string">&quot;https&quot;</span></span><br><span class="line">    path    = <span class="string">&quot;full/path&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">data <span class="string">&quot;terraform_remote_state&quot;</span> <span class="string">&quot;foo&quot;</span> &#123;</span><br><span class="line">  backend = <span class="string">&quot;consul&quot;</span></span><br><span class="line">  config = &#123;</span><br><span class="line">    path = <span class="string">&quot;full/path&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š <a href="https://theithollow.com/2018/05/21/using-hashicorp-consul-to-store-terraform-state/">https://theithollow.com/2018/05/21/using-hashicorp-consul-to-store-terraform-state/</a></p><h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><ul><li><p>å•è¡Œæ³¨é‡Šä»¥ # å¼€å¤´</p></li><li><p>å¤šè¡Œæ³¨é‡Šç”¨ /* å’Œ */ æ¢è¡Œ</p></li><li><p>å€¼ä½¿ç”¨ key = value çš„è¯­æ³•åˆ†é…ï¼ˆç©ºæ ¼æ— å…³ç´§è¦ï¼‰ã€‚è¯¥å€¼å¯ä»¥æ˜¯ä»»ä½•åŸè¯­ï¼ˆå­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”å€¼ï¼‰ï¼Œåˆ—è¡¨æˆ–æ˜ å°„ã€‚</p></li><li><p>å­—ç¬¦ä¸²ä¸ºåŒå¼•å·ã€‚</p></li><li><p>å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ ${} åŒ…è£…çš„è¯­æ³•å¯¹å…¶ä»–å€¼è¿›è¡Œæ’å€¼ï¼Œä¾‹å¦‚ ${var.foo} ã€‚æ­¤å¤„è®°å½•äº†å®Œæ•´çš„å†…æ’è¯­æ³•ã€‚</p></li><li><p>å¤šè¡Œå­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨å¤–å£³æ ·å¼çš„â€œ here docâ€è¯­æ³•ï¼Œè¯¥å­—ç¬¦ä¸²ä»¥ç±»ä¼¼ &lt;&lt;EOF çš„æ ‡è®°å¼€å¤´ï¼Œç„¶åä»¥ EOF ç»“å°¾ã€‚å­—ç¬¦ä¸²å’Œç»“æŸæ ‡å¿—çš„çº¿è·¯å¿…é¡»ä¸èƒ½ç¼©è¿›ã€‚</p></li><li><p>å‡å®šæ•°å­—ä»¥10ä¸ºåº•ã€‚å¦‚æœä¸ºæ•°å­—åŠ ä¸Š 0x å‰ç¼€ï¼Œåˆ™å°†å…¶è§†ä¸ºåå…­è¿›åˆ¶æ•°å­—ã€‚</p></li><li><p>å¸ƒå°”å€¼ï¼š true ï¼Œ false ã€‚</p></li><li><p>åŸå§‹ç±»å‹çš„åˆ—è¡¨å¯ä»¥ç”¨æ–¹æ‹¬å·ï¼ˆ [] ï¼‰åˆ¶æˆã€‚ç¤ºä¾‹ï¼š [â€œfooâ€, â€œbarâ€, â€œbazâ€] ã€‚</p></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://runebook.dev/zh-CN/docs/terraform/-index-#Alicloud">https://runebook.dev/zh-CN/docs/terraform/-index-#Alicloud</a></li><li><a href="https://www.terraform.io/">https://www.terraform.io/</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ç®€ä»‹ï¼š&quot;&gt;&lt;a href=&quot;#ç®€ä»‹ï¼š&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹ï¼š&quot;&gt;&lt;/a&gt;ç®€ä»‹ï¼š&lt;/h2&gt;&lt;p&gt;Terraformæ˜¯IT åŸºç¡€æ¶æ„è‡ªåŠ¨åŒ–ç¼–æ’å·¥å…·ï¼Œå®ƒçš„å£å·æ˜¯ â€œWrite,Plan, and create Infrastruct</summary>
      
    
    
    
    <category term="Cloud" scheme="https://acodetailor.github.io/categories/Cloud/"/>
    
    
    <category term="terraform" scheme="https://acodetailor.github.io/tags/terraform/"/>
    
  </entry>
  
</feed>
